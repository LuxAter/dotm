name: dotm
help: Personal dotfiles manager utility
version: 0.1.0

environment_variables:
  - name: DOTFILES
    required: true
    default: $HOME/dotfiles.new
    help: Path to the local dotfiles repository

commands:
  - name: completions
    short: C
    help: Generate bash autocompletions

  - name: update
    short: U
    help: Update and install the dotm script
    dependencies:
      - curl

    args:
      - name: path
        validate: dir_exists
        help: Path of the dotm installation to update

    flags:
      - long: --force
        short: -f
        help: Automatically accept all user prompts
      - long: --check
        short: -c
        help: Only check for updates, don't actually update
      - long: --no-completion
        short: -C
        help: Don't update the bash completions
      - long: --no-dotm
        short: -D
        help: Don't update the dotm script

  - name: add
    short: a
    group: Dotfile
    help: Add new files/directories to a dotfile package

    args:
      - name: files
        required: true
        repeatable: true
        help: List of files or directories to add into the dotfiles

    flags:
      - long: --force
        short: -f
        help: Automatically accept all user prompts
      - long: --package
        short: -p
        arg: PACKAGE
        default: host/$HOSTNAME
        help: Package to add the new dotfiles into

  - name: install
    short: i
    help: Copy dotfiles directly into system paths

    args:
      - name: packages
        repeatable: true
        default: host/$HOSTNAME
        help: List of dotfile packages to install into the system

    flags:
      - long: --force
        short: -f
        help: Automatically accept all user prompts

  - name: list
    short: l
    help: List the state of all the currently configured dotfiles

    args:
      - name: packages
        repeatable: true
        default: host/$HOSTNAME
        help: List of dotfile packages to include in the list

    flags:
      - long: --all
        short: -a
        help: Include all dotfiles in the list
      - long: --raw
        short: -r
        help: Display a raw list without styling, useful in scripts

  - name: remove
    short: r
    help: Remove file from a dotfile package

    args:
      - name: files
        required: true
        repeatable: true
        help: List of files or directories to be removed from the dotfiles

    flags:
      - long: --force
        short: -f
        help: Automatically accept all user prompts
      - long: --package
        short: -p
        arg: PACKAGE
        default: host/$HOSTNAME
        help: Package to remove the dotfiles from

  - name: set
    short: s
    help: Create links from system files into the dotfiles

    args:
      - name: packages
        repeatable: true
        default: host/$HOSTNAME
        help: List of dotfile packages to create the links for

    flags:
      - long: --force
        short: -f
        help: Automatically accept all user prompts

  - name: unset
    short: u
    help: Remove links from system files into the dotfiles

    args:
      - name: packages
        repeatable: true
        default: host/$HOSTNAME
        help: List of dotfile packages to remove the links of

    flags:
      - long: --force
        short: -f
        help: Automatically accept all user prompts

  - name: pull
    group: Git
    help: Pull changes from the remote git repo

  - name: push
    help: Push local changes to the remote git repo

  - name: sync
    help: Sync any changes with the remote git repo
